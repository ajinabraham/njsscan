rules:
  - id: serializetojs_deserialize
    patterns:
      - pattern-inside: |
          require('serialize-to-js')
          ...
      - pattern: |
          $X.deserialize(...)
    message: >-
      User controlled data in 'unserialize()' or 'deserialize()' function can
      result in Object Injection or Remote Code Injection.
    languages:
      - javascript
    severity: ERROR
    metadata:
      owasp-web: a8
      cwe:
        - 'CWE-502: Deserialization of Untrusted Data'
      owasp:
        - A08:2017 - Insecure Deserialization
        - A08:2021 - Software and Data Integrity Failures
  - id: node_deserialize
    patterns:
      - pattern-inside: |
          require('node-serialize')
          ...
      - pattern: |
          $X.unserialize(...)
    message: >-
      User controlled data in 'unserialize()' or 'deserialize()' function can
      result in Object Injection or Remote Code Injection.
    languages:
      - javascript
    severity: ERROR
    metadata:
      owasp-web: a8
      cwe:
        - 'CWE-502: Deserialization of Untrusted Data'
      owasp:
        - A08:2017 - Insecure Deserialization
        - A08:2021 - Software and Data Integrity Failures
